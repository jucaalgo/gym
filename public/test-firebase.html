<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Firebase Config Test</title>
</head>

<body style="background: #111; color: #fff; font-family: sans-serif; text-align: center; padding: 50px;">
    <h1>Firebase Credentials Test</h1>
    <div id="status">Ready to test.</div>
    <div id="error" style="color: red; margin-top: 20px;"></div>

    <button onclick="testConnection()" style="margin-top: 20px; padding: 10px 20px; font-size: 16px; cursor: pointer;">
        ðŸš€ TEST REAL CONNECTION (CLICK ME)
    </button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDVxYcBV9Lx3h0ZIGnfG3P7CGoSkGX9iGY",
            authDomain: "jca-gym-app.firebaseapp.com",
            projectId: "jca-gym-app",
            storageBucket: "jca-gym-app.firebasestorage.app",
            messagingSenderId: "449165119408",
            appId: "1:449165119408:web:99531cc1328e34f7361075"
        };

        window.testConnection = async () => {
            const statusDiv = document.getElementById('status');
            const errorDiv = document.getElementById('error');

            statusDiv.innerText = "â³ Attempting to talk to Google Servers...";
            statusDiv.style.color = "yellow";
            errorDiv.innerText = "";

            try {
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);

                // Try to create a dummy user (will fail if Email/Pass is disabled)
                const randomEmail = `test${Math.floor(Math.random() * 1000)}@test.com`;
                await createUserWithEmailAndPassword(auth, randomEmail, "12345678");

                statusDiv.innerText = "âœ… SUCCESS! Connected and created user: " + randomEmail;
                statusDiv.style.color = "lightgreen";

            } catch (e) {
                console.error(e);
                statusDiv.innerText = "âŒ FAILED (Server Rejected Request)";
                statusDiv.style.color = "red";

                // Pretty print the error
                let suggestion = "";
                if (e.code === 'auth/operation-not-allowed') suggestion = "ðŸ‘‰ SULUTION: Go to Firebase Console > Authentication > Sign-in method and ENABLE 'Email/Password'.";
                if (e.code === 'auth/invalid-api-key') suggestion = "ðŸ‘‰ SOLUTION: Your API Key is invalid in the code.";
                if (e.message.includes('requests from this Referer')) suggestion = "ðŸ‘‰ SOLUTION: Your API Key has domain restrictions. allow 'localhost' in Google Cloud Console.";

                errorDiv.innerHTML = `<strong>Error Code:</strong> ${e.code}<br><strong>Message:</strong> ${e.message}<br><br><span style='color:cyan'>${suggestion}</span>`;
            }
        }
    </script>
</body>

</html>